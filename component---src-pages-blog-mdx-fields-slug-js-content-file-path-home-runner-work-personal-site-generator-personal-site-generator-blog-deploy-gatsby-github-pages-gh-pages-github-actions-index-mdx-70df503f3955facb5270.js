"use strict";(self.webpackChunkpersonal_site_generator=self.webpackChunkpersonal_site_generator||[]).push([[23],{9626:function(e,t,n){n.d(t,{Zo:function(){return c},ah:function(){return i}});var l=n(7294);const a=l.createContext({});function i(e){const t=l.useContext(a);return l.useMemo((()=>"function"==typeof e?e(t):{...t,...e}),[t,e])}const r={};function c(e){let{components:t,children:n,disableParentContext:c}=e,o=i(t);return c&&(o=t||r),l.createElement(a.Provider,{value:o},n)}},9743:function(e,t,n){n.r(t),n.d(t,{default:function(){return E}});var l=n(9626),a=n(7294);function i(e){const t=Object.assign({ul:"ul",li:"li",a:"a",p:"p",section:"section",h2:"h2",div:"div",strong:"strong",code:"code",h3:"h3",pre:"pre"},(0,l.ah)(),e.components);return a.createElement(a.Fragment,null,a.createElement(t.ul,null,"\n",a.createElement(t.li,null,a.createElement(t.a,{href:"#initial-context"},"Initial Context"),"\n",a.createElement(t.ul,null,"\n",a.createElement(t.li,null,a.createElement(t.a,{href:"#setting-up-github-actions-secret"},"Setting up GitHub Actions secret")),"\n",a.createElement(t.li,null,a.createElement(t.a,{href:"#installing-npm-packages"},"Installing npm packages")),"\n"),"\n"),"\n",a.createElement(t.li,null,a.createElement(t.a,{href:"#setup-deployment"},"Setup Deployment"),"\n",a.createElement(t.ul,null,"\n",a.createElement(t.li,null,a.createElement(t.a,{href:"#making-the-deploy-script"},"Making the deploy script")),"\n",a.createElement(t.li,null,a.createElement(t.a,{href:"#setting-up-the-github-actions-workflow"},"Setting up the GitHub Actions workflow")),"\n"),"\n"),"\n",a.createElement(t.li,null,a.createElement(t.a,{href:"#conclusion"},"Conclusion")),"\n",a.createElement(t.li,null,a.createElement(t.a,{href:"#additional-resources"},"Additional Resources")),"\n"),"\n",a.createElement(t.p,null,"This tutorial will show you how to use gh-pages and GitHub Actions to automatically deploy a Gatsby project to Github Pages repo. These steps and scripts are currently in use on this site."),"\n",a.createElement(t.section,null,a.createElement(t.h2,{id:"initial-context",style:{position:"relative"}},a.createElement(t.a,{href:"#initial-context","aria-label":"initial context permalink",className:"anchor before"},a.createElement(t.div,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Initial Context"),a.createElement(t.p,null,"This guide assumes there are two git repos, one to house the Gatsby project code and one for the Github Pages public files. Each git repo will have these characteristics:"),a.createElement(t.ul,null,"\n",a.createElement(t.li,null,"Gatsby project repo","\n",a.createElement(t.ul,null,"\n",a.createElement(t.li,null,"static site generator source files"),"\n",a.createElement(t.li,null,"deploy script via package.json"),"\n",a.createElement(t.li,null,"GitHub Actions workflow yaml file"),"\n"),"\n"),"\n",a.createElement(t.li,null,"GitHub Pages repo","\n",a.createElement(t.ul,null,"\n",a.createElement(t.li,null,"files in repo were generated via Gatsby project"),"\n",a.createElement(t.li,null,"public web root for GitHub Pages","\n",a.createElement(t.ul,null,"\n",a.createElement(t.li,null,"https://docs.github.com/en/pages/getting-started-with-github-pages/creating-a-github-pages-site"),"\n"),"\n"),"\n",a.createElement(t.li,null,a.createElement(t.strong,null,"NOTE:")," For this tutorial, the git repo ",a.createElement(t.code,null,"https://github.com/username/username.github.io.git")," is assumed"),"\n"),"\n"),"\n"),a.createElement(t.section,null,a.createElement(t.h3,{id:"setting-up-github-actions-secret",style:{position:"relative"}},a.createElement(t.a,{href:"#setting-up-github-actions-secret","aria-label":"setting up github actions secret permalink",className:"anchor before"},a.createElement(t.div,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Setting up GitHub Actions secret"),a.createElement(t.p,null,"In order to transfer files from one GitHub repo to another, the GitHub Actions need an authentication token to commit to the correct repo; this is achieved via personal access tokens. Follow these steps to setup a secret for the personal access token."),a.createElement(t.ul,null,"\n",a.createElement(t.li,null,"Create the personal access token","\n",a.createElement(t.ul,null,"\n",a.createElement(t.li,null,"https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token"),"\n",a.createElement(t.li,null,a.createElement(t.strong,null,"NOTE:")," Token only needs repo access (read/write)"),"\n"),"\n"),"\n",a.createElement(t.li,null,"For the Gatsby project repo, store personal access token as a GitHub Actions secret","\n",a.createElement(t.ul,null,"\n",a.createElement(t.li,null,"https://docs.github.com/en/actions/security-guides/encrypted-secrets"),"\n",a.createElement(t.li,null,a.createElement(t.strong,null,"NOTE:")," In this tutorial, ",a.createElement(t.code,null,"PERSONAL_ACCESS_TOKEN")," is used as the key"),"\n"),"\n"),"\n"),a.createElement(t.p,null,"This secret will be used in both the deploy script and in the GitHub Actions workflow.")),a.createElement(t.section,null,a.createElement(t.h3,{id:"installing-npm-packages",style:{position:"relative"}},a.createElement(t.a,{href:"#installing-npm-packages","aria-label":"installing npm packages permalink",className:"anchor before"},a.createElement(t.div,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Installing npm packages"),a.createElement(t.p,null,"For the deploy script, two npm packages will be needed:"),a.createElement(t.ul,null,"\n",a.createElement(t.li,null,"Install ",a.createElement(t.a,{href:"https://www.gatsbyjs.com/docs/reference/gatsby-cli/",target:"_blank",rel:"noopener noreferrer"},"Gatsby CLI")," globally","\n",a.createElement(t.ul,null,"\n",a.createElement(t.li,null,a.createElement(t.strong,null,"NOTE:")," Most Gatsby projects may already have this installed globally."),"\n",a.createElement(t.li,null,"Run ",a.createElement(t.code,null,"npm install -g gatsby-cli")),"\n"),"\n"),"\n",a.createElement(t.li,null,"For the Gatsby project repo, install ",a.createElement(t.a,{href:"https://github.com/tschaub/gh-pages",target:"_blank",rel:"noopener noreferrer"},"gh-pages")," locally","\n",a.createElement(t.ul,null,"\n",a.createElement(t.li,null,"Run ",a.createElement(t.code,null,"npm install --save-dev gh-pages")),"\n"),"\n"),"\n"))),"\n",a.createElement(t.section,null,a.createElement(t.h2,{id:"setup-deployment",style:{position:"relative"}},a.createElement(t.a,{href:"#setup-deployment","aria-label":"setup deployment permalink",className:"anchor before"},a.createElement(t.div,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Setup Deployment"),a.createElement(t.p,null,"Now for the fun part! The next two scripts will work in tandem to deploy the Gatsby project to the Github Pages repo."),a.createElement(t.section,null,a.createElement(t.h3,{id:"making-the-deploy-script",style:{position:"relative"}},a.createElement(t.a,{href:"#making-the-deploy-script","aria-label":"making the deploy script permalink",className:"anchor before"},a.createElement(t.div,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Making the deploy script"),a.createElement(t.p,null,"Add this npm script to the Gatsby project's ",a.createElement(t.code,null,"project.json"),"."),a.createElement(t.pre,null,a.createElement(t.code,{className:"language-json"},'"scripts": {\n  ...\n  "deploy": "gatsby build && gh-pages -d public -b main -r https://$PERSONAL_ACCESS_TOKEN@github.com/username/username.github.io.git"\n}\n')),a.createElement(t.ul,null,"\n",a.createElement(t.li,null,a.createElement(t.code,null,"gatsby build")," will build the Gatsby site into the ",a.createElement(t.code,null,"public")," directory"),"\n",a.createElement(t.li,null,a.createElement(t.code,null,"gh-pages")," will deploy the site with these flag arguments","\n",a.createElement(t.ul,null,"\n",a.createElement(t.li,null,a.createElement(t.code,null,"-d public")," is the directory name which is getting deployed"),"\n",a.createElement(t.li,null,a.createElement(t.code,null,"-b main")," is the branch name of the destination repo"),"\n",a.createElement(t.li,null,a.createElement(t.code,null,"-r https://$PERSONAL_ACCESS_TOKEN@github.com/username/username.github.io.git")," is the destination repo","\n",a.createElement(t.ul,null,"\n",a.createElement(t.li,null,a.createElement(t.code,null,"$PERSONAL_ACCESS_TOKEN")," is the authentication token which was ",a.createElement(t.a,{href:"#setting-up-github-actions-secret"},"setup earlier")),"\n"),"\n"),"\n"),"\n"),"\n")),a.createElement(t.section,null,a.createElement(t.h3,{id:"setting-up-the-github-actions-workflow",style:{position:"relative"}},a.createElement(t.a,{href:"#setting-up-the-github-actions-workflow","aria-label":"setting up the github actions workflow permalink",className:"anchor before"},a.createElement(t.div,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Setting up the GitHub Actions workflow"),a.createElement(t.p,null,"Add this yaml file to the Gatsby project's ",a.createElement(t.code,null,".github/workflows")," directory. This tutorial will name the yaml file ",a.createElement(t.code,null,"deploy.yaml"),", resulting in ",a.createElement(t.code,null,".github/workflows/deploy.yaml"),"."),a.createElement(t.pre,null,a.createElement(t.code,{className:"language-yaml"},'name: Deploy site\n\non:\n  push:\n    branches: [ main ]\n\njobs:\n  deploy-site:\n    runs-on: ubuntu-latest\n    steps:\n    - name: Checkout git branch\n      uses: actions/checkout@v3.0.0\n    - name: Setup Node.js\n      uses: actions/setup-node@v3.0.0\n      with:\n        node-version: \'16\'\n    - run: npm install\n    - name: Deploy site\n      run: |\n        npm run deploy -- -m "deploy site via GitHub Actions" -u "github-actions-bot <support+actions@github.com>"\n      env:\n        PERSONAL_ACCESS_TOKEN: ${{ secrets.PERSONAL_ACCESS_TOKEN }}\n')),a.createElement(t.ul,null,"\n",a.createElement(t.li,null,a.createElement(t.code,null,"push")," command will trigger ths workflow on any ",a.createElement(t.code,null,"git push")," to the ",a.createElement(t.code,null,"main")," branch"),"\n",a.createElement(t.li,null,a.createElement(t.code,null,"uses: actions/checkout@v3.0.0")," checks out the ",a.createElement(t.code,null,"main")," branch"),"\n",a.createElement(t.li,null,a.createElement(t.code,null,"uses: actions/setup-node@v3.0.0")," installs Node.js to the environment"),"\n",a.createElement(t.li,null,a.createElement(t.code,null,"- run: npm install")," installs npm packages dependencies"),"\n",a.createElement(t.li,null,a.createElement(t.code,null,'npm run deploy -- -m "deploy site via GitHub Actions" -u "github-actions-bot <support+actions@github.com>"')," will run the deploy script with extra arguments for ",a.createElement(t.code,null,"gh-pages")," commit to the GitHub Pages repo","\n",a.createElement(t.ul,null,"\n",a.createElement(t.li,null,a.createElement(t.code,null,'-m "deploy site via GitHub Actions"')," is the commit message"),"\n",a.createElement(t.li,null,a.createElement(t.code,null,'-u "github-actions-bot <support+actions@github.com>"')," is the commit user"),"\n"),"\n"),"\n",a.createElement(t.li,null,a.createElement(t.code,null,"PERSONAL_ACCESS_TOKEN: ${{ secrets.PERSONAL_ACCESS_TOKEN }}")," is how the GitHub Actions secret gets pass through to the ",a.createElement(t.code,null,"package.json")),"\n"))),"\n",a.createElement(t.section,null,a.createElement(t.h2,{id:"conclusion",style:{position:"relative"}},a.createElement(t.a,{href:"#conclusion","aria-label":"conclusion permalink",className:"anchor before"},a.createElement(t.div,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Conclusion"),a.createElement(t.p,null,"That's it! Any push to the Gatsby project GitHub repo will trigger an automatic build and deploy. Assuming ",a.createElement(t.code,null,"username.github.io")," was the repo name and ",a.createElement(t.a,{href:"https://docs.github.com/en/pages/getting-started-with-github-pages/creating-a-github-pages-site",target:"_blank",rel:"noopener noreferrer"},"GitHub Pages was configured"),", there should be a live site at ",a.createElement(t.code,null,"https://username.github.io"),"!")),"\n",a.createElement(t.section,null,a.createElement(t.h2,{id:"additional-resources",style:{position:"relative"}},a.createElement(t.a,{href:"#additional-resources","aria-label":"additional resources permalink",className:"anchor before"},a.createElement(t.div,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Additional Resources"),a.createElement(t.ul,null,"\n",a.createElement(t.li,null,"https://www.gatsbyjs.com/docs/how-to/previews-deploys-hosting/how-gatsby-works-with-github-pages/"),"\n",a.createElement(t.li,null,"https://github.com/tschaub/gh-pages"),"\n",a.createElement(t.li,null,"https://www.xkoji.dev/blog/set-up-a-blog-with-gatsby-github-pages-and-github-actions/"),"\n")))}var r=function(e){void 0===e&&(e={});const{wrapper:t}=Object.assign({},(0,l.ah)(),e.components);return t?a.createElement(t,e,a.createElement(i,e)):i(e)},c=n(1082),o=n(5414),s=n(7671),u=n.n(s),m=n(6961),h=n(1755),p=n(4589);function d(e){let{pageMeta:t}=e;const{title:n,description:l,uri:i,publishedDate:r,modifiedDate:c,siteName:s,siteUrl:u,image:m,social:h}=t,p={"@context":"https://schema.org/","@graph":[{"@type":"BreadcrumbList","@id":u,name:s,itemListElement:[{"@type":"ListItem",position:1,name:"Blog",item:`${u}/blog/`},{"@type":"ListItem",position:2,name:n}]},{"@type":"BlogPosting",mainEntityOfPage:{"@type":"WebPage","@id":`${u}/${i}/`},headline:n,description:l,author:{"@type":"Person",name:s,url:u,sameAs:[h.linkedinUrl,h.githubUrl],jobTitle:"Web Developer"},image:m,datePublished:r,dateModified:c}]},d=JSON.stringify(p);return a.createElement(o.q,null,a.createElement("meta",{property:"og:type",content:"article"}),a.createElement("meta",{property:"article:author",content:s}),a.createElement("meta",{property:"article:published_time",content:r}),a.createElement("meta",{property:"article:modified_time",content:c}),a.createElement("script",{type:"application/ld+json"},d))}function g(e){let{pageContext:t,data:n,children:i}=e;const r=n.allMdx.edges.find((e=>{let{node:n}=e;return n.id===t.id})),o=r.node,s=n.site.siteMetadata,{title:g,description:E,publishedDate:b,modifiedDate:f,prettyPublishedDate:y,prettyModifiedDate:v}=o.frontmatter,w={title:g,description:E,uri:`blog/${o.fields.slug}`,publishedDate:b,modifiedDate:f,siteName:s.title,siteUrl:s.siteUrl,image:s.image,social:s.social},S=f!==b,k={Emoji:u()};return a.createElement(m.Z,null,a.createElement(h.Z,{pageMeta:w}),a.createElement(d,{pageMeta:w}),a.createElement("article",{className:p.Y},a.createElement("header",null,a.createElement("h1",null,g),a.createElement("p",null,a.createElement("time",{dateTime:b}," Published: ",y),S&&a.createElement(a.Fragment,null,a.createElement("br"),a.createElement("time",{dateTime:f}," Modified: ",v)))),a.createElement(l.Zo,{components:k},i),a.createElement("footer",null,a.createElement("div",null,r.previous&&a.createElement("article",null,a.createElement("p",null,"<-- Previous post"),a.createElement(c.rU,{to:`/blog/${r.previous.fields.slug}/`},a.createElement("h3",null,r.previous.frontmatter.title)))),a.createElement("div",{className:p.l},r.next&&a.createElement("article",null,a.createElement("p",null,"Next post --\x3e"),a.createElement(c.rU,{to:`/blog/${r.next.fields.slug}/`},a.createElement("h3",null,r.next.frontmatter.title)))))))}function E(e){return a.createElement(g,e,a.createElement(r,e))}},4589:function(e,t,n){n.d(t,{Y:function(){return l},l:function(){return a}});var l="single-blog-module--article--tlSFO",a="single-blog-module--next--Rxiuo"}}]);
//# sourceMappingURL=component---src-pages-blog-mdx-fields-slug-js-content-file-path-home-runner-work-personal-site-generator-personal-site-generator-blog-deploy-gatsby-github-pages-gh-pages-github-actions-index-mdx-70df503f3955facb5270.js.map